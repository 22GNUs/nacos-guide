<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nacos源码开篇 | Nacos Guide</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="微服务Nacos组件，值得学习和研究">
    
    <link rel="preload" href="/nacos-guide/assets/css/0.styles.315a301c.css" as="style"><link rel="preload" href="/nacos-guide/assets/js/app.45c81130.js" as="script"><link rel="preload" href="/nacos-guide/assets/js/2.8d615e8a.js" as="script"><link rel="preload" href="/nacos-guide/assets/js/3.89e39340.js" as="script"><link rel="prefetch" href="/nacos-guide/assets/js/10.b1338574.js"><link rel="prefetch" href="/nacos-guide/assets/js/11.1b50c31c.js"><link rel="prefetch" href="/nacos-guide/assets/js/12.51496516.js"><link rel="prefetch" href="/nacos-guide/assets/js/13.0140e640.js"><link rel="prefetch" href="/nacos-guide/assets/js/14.1a351c45.js"><link rel="prefetch" href="/nacos-guide/assets/js/15.862b71d1.js"><link rel="prefetch" href="/nacos-guide/assets/js/4.df83c0bb.js"><link rel="prefetch" href="/nacos-guide/assets/js/5.c18f992b.js"><link rel="prefetch" href="/nacos-guide/assets/js/6.7765b488.js"><link rel="prefetch" href="/nacos-guide/assets/js/7.6004fdc4.js"><link rel="prefetch" href="/nacos-guide/assets/js/8.5ea9895a.js"><link rel="prefetch" href="/nacos-guide/assets/js/9.998f76f7.js">
    <link rel="stylesheet" href="/nacos-guide/assets/css/0.styles.315a301c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nacos-guide/" class="home-link router-link-active"><!----> <span class="site-name">Nacos Guide</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nacos-guide/guide/list/01.html" class="nav-link">
  导读
</a></div><div class="nav-item"><a href="/nacos-guide/nacos2/" class="nav-link router-link-active">
  Nacox2.x
</a></div><div class="nav-item"><a href="/nacos-guide/question/" class="nav-link">
  常见问题
</a></div><div class="nav-item"><a href="/nacos-guide/about/" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nacos-guide/guide/list/01.html" class="nav-link">
  导读
</a></div><div class="nav-item"><a href="/nacos-guide/nacos2/" class="nav-link router-link-active">
  Nacox2.x
</a></div><div class="nav-item"><a href="/nacos-guide/question/" class="nav-link">
  常见问题
</a></div><div class="nav-item"><a href="/nacos-guide/about/" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Nacos2.1.0</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nacos-guide/nacos2/01-Nacos源码开篇/Nacos源码分析开篇.html" class="active sidebar-link">1.Nacos源码开篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nacos-guide/nacos2/01-Nacos源码开篇/Nacos源码分析开篇.html#nacos服务注册与发现源码剖析" class="sidebar-link">Nacos服务注册与发现源码剖析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nacos-guide/nacos2/01-Nacos源码开篇/Nacos源码分析开篇.html#nacos核心功能点" class="sidebar-link">Nacos核心功能点</a></li><li class="sidebar-sub-header"><a href="/nacos-guide/nacos2/01-Nacos源码开篇/Nacos源码分析开篇.html#nacos服务端原理" class="sidebar-link">Nacos服务端原理</a></li><li class="sidebar-sub-header"><a href="/nacos-guide/nacos2/01-Nacos源码开篇/Nacos源码分析开篇.html#nacos客户端原理" class="sidebar-link">Nacos客户端原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/nacos-guide/nacos2/01-Nacos源码开篇/Nacos源码分析开篇.html#nacos源码下载" class="sidebar-link">Nacos源码下载</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nacos源码开篇"><a href="#nacos源码开篇" class="header-anchor">#</a> Nacos源码开篇</h1> <h2 id="nacos服务注册与发现源码剖析"><a href="#nacos服务注册与发现源码剖析" class="header-anchor">#</a> Nacos服务注册与发现源码剖析</h2> <h3 id="nacos核心功能点"><a href="#nacos核心功能点" class="header-anchor">#</a> Nacos核心功能点</h3> <p><strong>服务注册</strong>：Nacos Client会通过发送REST请求的方式向Nacos Server注册自己的服务，提供自身的元数据，比如ip地址、端口等信息。Nacos Server接收到注册请求后，就会把这些元数据信息存储在一个双层的内存Map中。</p> <p><strong>服务心跳</strong>：在服务注册后，Nacos Client会维护一个定时心跳来持续通知Nacos Server，说明服务一直处于可用状态，防止被剔除。默认5s发送一次心跳。</p> <p><strong>服务健康检查</strong>：Nacos Server会开启一个定时任务用来检查注册服务实例的健康情况，对于超过15s没有收到客户端心跳的实例会将它的healthy属性置为false(客户端服务发现时不会发现)，如果某个实例超过30秒没有收到心跳，直接剔除该实例(被剔除的实例如果恢复发送心跳则会重新注册)</p> <p><strong>服务发现</strong>：服务消费者（Nacos Client）在调用服务提供者的服务时，会发送一个REST请求给Nacos Server，获取上面注册的服务清单，并且缓存在Nacos Client本地，同时会在Nacos Client本地开启一个定时任务定时拉取服务端最新的注册表信息更新到本地缓存</p> <p><strong>服务同步</strong>：Nacos Server集群之间会互相同步服务实例，用来保证服务信息的一致性。</p> <h3 id="nacos服务端原理"><a href="#nacos服务端原理" class="header-anchor">#</a> Nacos服务端原理</h3> <p><img src="/nacos-guide/assets/img/20190703005818162.35053b71.png" alt="在这里插入图片描述"></p> <h3 id="nacos客户端原理"><a href="#nacos客户端原理" class="header-anchor">#</a> Nacos客户端原理</h3> <p><img src="/nacos-guide/assets/img/20190703005828565.e48e6ff1.png" alt="在这里插入图片描述"></p> <p>​	其实从以上的两张图中我们就能够找到突破口了，其实核心内容就集中在nacos-console、nacos-naming、nacos-config，这几个模块中。那么知道了这些，现在我们就来进行Nacos的源码下载，然后我们具体分析。</p> <h2 id="nacos源码下载"><a href="#nacos源码下载" class="header-anchor">#</a> Nacos源码下载</h2> <p>我们本次需要通过Nacos来运行Nacos，所以下载地址为：https://github.com/alibaba/nacos，我们需要通过Idea来进行下载，以下是具体下载步骤</p> <p><img src="/nacos-guide/assets/img/image-20211011183821099.85509ee0.png" alt="image-20211011183821099"></p> <p><img src="/nacos-guide/assets/img/image-20211011183927440.4b083765.png" alt="image-20211011183927440"></p> <p>下载好之后我们需要启动Nacos，那么我们首先要找到nacos-console这个模块，找到启动类，同时还要配置启动模式为单机（我们还是以单机模式为演示）</p> <p><img src="/nacos-guide/assets/img/image-20211011184215671.ad24f75b.png" alt="image-20211011184215671"></p> <p>设置单机运行</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">-</span><span class="token class-name">Dnacos</span><span class="token punctuation">.</span>standalone<span class="token operator">=</span><span class="token boolean">true</span> <span class="token operator">-</span><span class="token class-name">Dnacos</span><span class="token punctuation">.</span>home<span class="token operator">=</span><span class="token class-name">C</span><span class="token operator">:</span>\\nacos
</code></pre></div><p><img src="/nacos-guide/assets/img/image-20211012182029525.1a2f26fd.png" alt="image-20211012182029525"></p> <p>项目配置好之后，我们来看一下Nacos所有的模块</p> <p><img src="/nacos-guide/assets/img/20190703005808640.668458ae.png" alt="在这里插入图片描述"></p> <p>​	配置好之后就可以运行测试，和启动普通的SpringBoot聚合项目一样，启动之后我们也可以直接访问：http://localhost:8848/nacos，这个时候就能看到我们以前看到的对应客户端页面了，到此为止我们的Nacos源码启动就完成了。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022-6-29 22:43:05</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/nacos-guide/assets/js/app.45c81130.js" defer></script><script src="/nacos-guide/assets/js/2.8d615e8a.js" defer></script><script src="/nacos-guide/assets/js/3.89e39340.js" defer></script>
  </body>
</html>
